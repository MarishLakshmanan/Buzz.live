{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\sakth\\\\Documents\\\\Buzz.live\\\\frontend\\\\buzz.live\\\\src\\\\pages\\\\ChatRoom.js\",\n    _s = $RefreshSig$();\n\nimport { useNavigate, useParams } from \"react-router-dom\";\nimport { checkAuth } from \"../functions/Authorization\";\nimport { useEffect } from \"react\";\nimport { io } from \"socket.io-client\";\nimport Peer from \"peerjs\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction ChatRoom() {\n  _s();\n\n  const navigate = useNavigate();\n  const roomID = useParams().params;\n  useEffect(() => {\n    checkAuth(navigate);\n    initSocketConnection(roomID); // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    id: \"r-video-container\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 20,\n    columnNumber: 9\n  }, this);\n}\n\n_s(ChatRoom, \"NUN0o9TUPSxWw6RZ9tA0ZhRvyuQ=\", false, function () {\n  return [useNavigate, useParams];\n});\n\n_c = ChatRoom;\n\nfunction initSocketConnection(roomID) {\n  const peer = new Peer();\n  const socket = io(\"http://localhost:5000\");\n  peer.on(\"open\", id => {\n    socket.emit(\"join-room\", roomID, id);\n  });\n  navigator.mediaDevices.getUserMedia({\n    video: true,\n    audio: false\n  }).then(yourStream => {\n    peer.on(\"call\", call => {\n      call.answer(yourStream);\n      const video2 = document.createElement(\"video\");\n      call.on(\"stream\", anotherStream => {\n        addVideoStream(video2, anotherStream);\n      });\n    });\n    const video = document.createElement(\"video\");\n    addVideoStream(video, yourStream);\n    socket.on(\"user-joined\", userID => {\n      connectToNewUser(userID, yourStream, peer);\n    });\n  });\n}\n\nfunction addVideoStream(video, stream) {\n  const container = document.getElementById(\"r-video-container\");\n  video.srcObject = stream;\n  video.addEventListener(\"loadedmetadata\", () => {\n    video.play();\n  });\n  container.appendChild(video);\n}\n\nfunction connectToNewUser(userID, yourStream, peer) {\n  const call = peer.call(userID, yourStream);\n  const video = document.createElement(\"video\");\n  call.on(\"stream\", anotherUserstream => {\n    addVideoStream(video, anotherUserstream);\n  });\n}\n\nexport default ChatRoom;\n\nvar _c;\n\n$RefreshReg$(_c, \"ChatRoom\");","map":{"version":3,"sources":["C:/Users/sakth/Documents/Buzz.live/frontend/buzz.live/src/pages/ChatRoom.js"],"names":["useNavigate","useParams","checkAuth","useEffect","io","Peer","ChatRoom","navigate","roomID","params","initSocketConnection","peer","socket","on","id","emit","navigator","mediaDevices","getUserMedia","video","audio","then","yourStream","call","answer","video2","document","createElement","anotherStream","addVideoStream","userID","connectToNewUser","stream","container","getElementById","srcObject","addEventListener","play","appendChild","anotherUserstream"],"mappings":"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","sourcesContent":["import { useNavigate , useParams } from \"react-router-dom\";\r\nimport { checkAuth } from \"../functions/Authorization\";\r\nimport {useEffect} from \"react\"\r\nimport {io} from \"socket.io-client\";\r\nimport Peer from \"peerjs\";\r\n\r\nfunction ChatRoom(){\r\n\r\n    const navigate = useNavigate();\r\n    const roomID = useParams().params;\r\n\r\n    useEffect(()=>{\r\n        checkAuth(navigate);\r\n\r\n        initSocketConnection(roomID);\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    },[]);\r\n\r\n    return(\r\n        <div id = \"r-video-container\">\r\n            \r\n        </div>\r\n    )\r\n}\r\n\r\n\r\nfunction initSocketConnection(roomID){\r\n    const peer = new Peer();\r\n    const socket = io(\"http://localhost:5000\")\r\n\r\n    peer.on(\"open\",(id)=>{\r\n        socket.emit(\"join-room\",roomID,id)\r\n    })\r\n\r\n    navigator.mediaDevices.getUserMedia({\r\n        video:true,\r\n        audio:false,\r\n    }).then((yourStream)=>{\r\n\r\n        peer.on(\"call\",(call)=>{\r\n            call.answer(yourStream);\r\n            const video2 = document.createElement(\"video\")\r\n            call.on(\"stream\",(anotherStream)=>{\r\n                addVideoStream(video2,anotherStream);\r\n            })\r\n        })\r\n\r\n        const video = document.createElement(\"video\")\r\n        addVideoStream(video,yourStream);\r\n\r\n        socket.on(\"user-joined\",(userID)=>{\r\n            connectToNewUser(userID,yourStream,peer);\r\n        })\r\n    })\r\n\r\n}\r\n\r\nfunction addVideoStream(video,stream){\r\n    const container = document.getElementById(\"r-video-container\");\r\n    video.srcObject = stream;\r\n    video.addEventListener(\"loadedmetadata\",()=>{\r\n        video.play();\r\n    })\r\n    container.appendChild(video);\r\n}\r\n\r\nfunction connectToNewUser(userID,yourStream,peer){\r\n    const call = peer.call(userID,yourStream);\r\n    const video = document.createElement(\"video\");\r\n    call.on(\"stream\",(anotherUserstream)=>{\r\n        addVideoStream(video,anotherUserstream);\r\n    })\r\n}\r\n\r\nexport default ChatRoom;"]},"metadata":{},"sourceType":"module"}